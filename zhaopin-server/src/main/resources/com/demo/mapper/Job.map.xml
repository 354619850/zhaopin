<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.model.Job">
	<resultMap id="Job" type="com.demo.model.Job">
    	<id property="id" column="id" jdbcType="BIGINT" />
		<result property="name" column="name" jdbcType="VARCHAR" />		
		<result property="salary_upper" column="salary_upper" jdbcType="INTEGER" />
		<result property="salary_lower" column="salary_lower" jdbcType="INTEGER" />	
		<result property="status" column="status" jdbcType="BOOLEAN" />	
		<result property="workplace" column="workplace" jdbcType="VARCHAR" />	
		<result property="city" column="city" jdbcType="VARCHAR" />
		<result property="degree_limit" column="degree_limit" jdbcType="VARCHAR" />		
		<result property="welfare" column="welfare" jdbcType="VARCHAR" />
		<result property="release_date" column="release_date" jdbcType="VARCHAR" />
		<result property="company_id" column="company_id" jdbcType="BIGINT" />
		<result property="hr_id" column="hr_id" jdbcType="VARCHAR" />	
		<result property="job_search" column="job_search" jdbcType="BIGINT" />
		<result property="type" column="type" jdbcType="VARCHAR" />	    	
		<association property="company" javaType="com.demo.model.Company">
			<id property="id" column="id" jdbcType="BIGINT" />
	        <result property="name" column="name" jdbcType="VARCHAR" />
	        <result property="scale" column="scale" jdbcType="VARCHAR" />
	        <result property="financing_stage" column="financing_stage" jdbcType="VARCHAR" />	
	        <result property="address" column="address" jdbcType="VARCHAR" />
	       	<result property="province" column="province" jdbcType="VARCHAR" />
	       	<result property="city" column="city" jdbcType="VARCHAR" />     
	        <result property="description" column="description" jdbcType="VARCHAR" />  
	        <result property="district" column="district" jdbcType="VARCHAR" />      
	        <result property="field" column="field" jdbcType="VARCHAR" />       
	   	</association>
	</resultMap>

	<sql id="TableName">
		job
	</sql>
	
	<select id='getSearchRecommand' resultType='String'>
		select name from <include refid="TableName" />
		where 
		<foreach collection="keys" item="key" index="index" open="" close=" " separator="and">
			name like CONCAT('%',#{key},'%')
		</foreach> 
		<foreach collection="workplaces" item="workplace" index="index" open="and" close=" " separator="and">
			workplace like CONCAT('%',#{workplace},'%')
		</foreach>
		group by name
	</select>
	
	<select id='searchJob' resultMap='Job'>
		select job.*,company.* from <include refid='TableName' />,company
		where job.company_id=company.id and job_search like CONCAT('%',#{job_search},'%') and city like concat('%',#{city},'%')
	</select>
	
	<select id='getIndexSearch' resultMap='Job'>
		select job.*,company.* from <include refid='TableName' />,company
		where job.company_id=company.id and job_search like concat('%',#{key},'%')
	</select>
	
</mapper>

<!-- parameterType:使用的参数类型
id:方法名
resultMap和resultType不能一起用 -->
